<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Arcunox Alias Generator</title>

  <style>
html, body,
#app,
.plate,
.wrap,
.titlebar,
.footnote,
.title,
.row,
label,
div,
section,
input,
button,
.btn-generate,
.copy-btn,
.output,
.output span {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: #050609;
  color: #f5f5f5;
  font-family: system-ui, -apple-system, BlinkMacSystemFont,
               "SF Pro Text", "Segoe UI", sans-serif;
}

body {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding-top: 40px;
}

#app {
  width: 1080px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.titlebar {
  width: 100%;
  padding: 14px 0;
  text-align: center;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 13px;
  color: #888;
  border-bottom: 1px solid #222;
  margin-bottom: 40px;
}

.plate {
  width: 500px;
  padding: 32px;
  background: #0b0c10;
  border: 1px solid #222;
}

.wrap {
  width: 100%;
}

.footnote {
  margin-top: 16px;
  font-size: 10px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: #555;
}

.title {
  text-transform: uppercase;
  letter-spacing: 0.16em;
  font-size: 14px;
  color: #888;
  margin-bottom: 18px;
}

.row {
  margin-bottom: 16px;
}

label {
  display: block;
  font-size: 11px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #777;
  margin-bottom: 6px;
}

input[type="text"] {
  width: 100%;
  padding: 8px 10px;
  background: #121318;
  border: 1px solid #333;
  color: #f5f5f5;
  font-size: 13px;
  outline: none;
}

input[type="text"]:focus {
  border-color: #f5f5f5;
}

input::placeholder {
  font-style: italic;
  color: #555;
}

.btn-generate {
  width: 100%;
  border: 1px solid #f5f5f5;
  background: #f5f5f5;
  color: #050609;
  padding: 9px 10px;
  font-size: 12px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  cursor: pointer;
  margin-bottom: 16px;
}

.btn-generate:active {
  background: #ddd;
}

.output {
  font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
               "Liberation Mono", monospace;
  font-size: 13px;
  padding: 10px;
  background: #0b0c10;
  border: 1px solid #333;
  min-height: 38px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  word-break: break-all;
}

.output span {
  flex: 1;
}

.copy-btn {
  border: 1px solid #333;
  background: transparent;
  color: #aaa;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  padding: 4px 6px;
  cursor: pointer;
  white-space: nowrap;
}

/* segmented controls */
.seg {
  display: flex;
  width: 100%;
  border: 1px solid #333;
}

.seg-btn {
  flex: 1;
  padding: 8px 0;
  background: #121318;
  border: none;
  border-right: 1px solid #333;
  color: #f5f5f5;
  font-size: 11px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  cursor: pointer;
}

.seg-btn:last-child {
  border-right: none;
}

.seg-btn.active {
  background: #1a1c22;
  border-bottom: 1px solid #f5f5f5;
}
  </style>
</head>

<body>
<div id="app">

  <div class="titlebar">Arcunox / Alias Generator</div>

  <div class="plate">
    <div class="wrap">

      <div class="title">Alias</div>

      <div class="row">
        <label for="seed">Seed</label>
        <input id="seed" type="text" placeholder="optional" autocomplete="off" spellcheck="false">
      </div>

      <div class="row">
        <label for="domain">Domain</label>
        <input id="domain" type="text" placeholder="optional" autocomplete="off" spellcheck="false">
      </div>

      <!-- PREFIX -->
      <div class="row">
        <label>Prefix</label>
        <div class="seg" id="prefixSeg">
          <button type="button" data-val="yes" class="seg-btn active">yes</button>
          <button type="button" data-val="no"  class="seg-btn">no</button>
        </div>
      </div>

      <!-- UNIVERSAL SEPARATOR -->
      <div class="row">
        <label>Separator</label>
        <div class="seg" id="sepSeg">
          <button type="button" data-val="none" class="seg-btn active">none</button>
          <button type="button" data-val="_"    class="seg-btn">underscore</button>
          <button type="button" data-val="-"    class="seg-btn">hyphen</button>
          <button type="button" data-val="."    class="seg-btn">period</button>
        </div>
      </div>

      <button class="btn-generate" id="generateBtn">Generate</button>

      <div class="output">
        <span id="aliasOutput"></span>
        <button class="copy-btn" id="copyBtn">Copy</button>
      </div>

    </div>
  </div>

  <div class="footnote">No logs. No analytics. All clientâ€‘side.</div>

</div>

<script type="module">
  import { MODES } from "./vocab.js";

  function randInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function randomChoice(arr) {
    return arr[randInt(0, arr.length - 1)];
  }

  function randomEntropy(len) {
    const letters = "abcdefghjkmnpqrstuvwxyz";
    const digits = "23456789";
    const chars = letters + digits;

    let out = "";
    for (let i = 0; i < len; i++) {
      out += chars.charAt(randInt(0, chars.length - 1));
    }

    if (!/[0-9]/.test(out)) {
      const pos = randInt(0, len - 1);
      const digit = digits.charAt(randInt(0, digits.length - 1));
      out = out.substring(0, pos) + digit + out.substring(pos + 1);
    }

    return out;
  }

  function normalizeShard(seed, fallbackShards) {
    const s = (seed || "").trim();
    if (!s) return randomChoice(fallbackShards);
    return s.toLowerCase().replace(/\s+/g, "-");
  }

  let currentMode = "abstract";

  const seedInput    = document.getElementById("seed");
  const domainInput  = document.getElementById("domain");
  const generateBtn  = document.getElementById("generateBtn");
  const aliasOutput  = document.getElementById("aliasOutput");
  const copyBtn      = document.getElementById("copyBtn");

  let prefixEnabled = true;
  let separator = "";

  function initSegControl(id, callback) {
    const seg = document.getElementById(id);
    const buttons = seg.querySelectorAll(".seg-btn");

    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        buttons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        callback(btn.getAttribute("data-val"));
      });
    });
  }

  initSegControl("prefixSeg", val => {
    prefixEnabled = (val === "yes");
  });

  initSegControl("sepSeg", val => {
    separator = (val === "none") ? "" : val;
  });

  function generateAlias() {
    const mode = MODES[currentMode];
    const seed = seedInput.value;

    const domainRaw = (domainInput.value || "").trim();
    const domain = domainRaw === "" ? "" : domainRaw;

    const prefix  = randomChoice(mode.prefixes);
    const entropy = randomEntropy(randInt(4, 6));
    const shard   = normalizeShard(seed, mode.shards);

    let localPart = "";

    if (prefixEnabled) {
      localPart = `${prefix}${separator}${entropy}${separator}${shard}`;
    } else {
      localPart = `${entropy}${separator}${shard}`;
    }

    const alias = domain === "" ? localPart : `${localPart}@${domain}`;

    aliasOutput.textContent = alias;
    return alias;
  }

  generateBtn.addEventListener("click", generateAlias);

  copyBtn.addEventListener("click", async () => {
    const alias = aliasOutput.textContent.trim();
    if (!alias) return;

    try {
      await navigator.clipboard.writeText(alias);
      const original = copyBtn.textContent;
      copyBtn.textContent = "Copied";
      setTimeout(() => (copyBtn.textContent = original), 900);
    } catch (e) {}
  });

  generateAlias();
</script>

</body>
</html>
